(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{"0/6H":function(e,t,n){"use strict";n.d(t,"a",function(){return o});var i=n("A36C"),s=n("iWo5"),r=n("qULd");const o=(e,t)=>{let n,o;const c=(e,i,s)=>{if("undefined"==typeof document)return;const r=document.elementFromPoint(e,i);r&&t(r)?r!==n&&(u(),a(r,s)):u()},a=(e,t)=>{n=e,o||(o=n);const s=n;Object(i.f)(()=>s.classList.add("ion-activated")),t()},u=(e=!1)=>{if(!n)return;const t=n;Object(i.f)(()=>t.classList.remove("ion-activated")),e&&o!==n&&n.click(),n=void 0};return Object(s.createGesture)({el:e,gestureName:"buttonActiveDrag",threshold:0,onStart:e=>c(e.currentX,e.currentY,r.a),onMove:e=>c(e.currentX,e.currentY,r.b),onEnd:()=>{u(!0),Object(r.e)(),o=void 0}})}},"74mu":function(e,t,n){"use strict";n.d(t,"a",function(){return s}),n.d(t,"b",function(){return r}),n.d(t,"c",function(){return i}),n.d(t,"d",function(){return c});const i=(e,t)=>null!==t.closest(e),s=(e,t)=>"string"==typeof e&&e.length>0?Object.assign({"ion-color":!0,[`ion-color-${e}`]:!0},t):t,r=e=>{const t={};return(e=>void 0!==e?(Array.isArray(e)?e:e.split(" ")).filter(e=>null!=e).map(e=>e.trim()).filter(e=>""!==e):[])(e).forEach(e=>t[e]=!0),t},o=/^[a-z][a-z0-9+\-.]*:/,c=async(e,t,n,i)=>{if(null!=e&&"#"!==e[0]&&!o.test(e)){const s=document.querySelector("ion-router");if(s)return null!=t&&t.preventDefault(),s.push(e,n,i)}return!1}},XLi0:function(e,t,n){"use strict";n.d(t,"a",function(){return m});var i=n("Jgta"),s=n("lJxs"),r=n("zx2A");function o(e){return t=>t.lift(new c(e))}class c{constructor(e){this.notifier=e}call(e,t){const n=new a(e),i=Object(r.c)(this.notifier,new r.a(n));return i&&!n.seenValue?(n.add(i),t.subscribe(n)):n}}class a extends r.b{constructor(e){super(e),this.seenValue=!1}notifyNext(){this.seenValue=!0,this.complete()}notifyComplete(){}}var u=n("IzEk"),l=n("XNiG"),d=n("fXoL"),b=n("I/3d"),h=n("lGQG"),f=n("UbJi");let m=(()=>{class e{constructor(e,t,n){this.db=e,this.auth=t,this.afAuth=n,this.ngUnsubscribe=new l.a,this.afAuth.authState.subscribe(e=>{e||(this.ngUnsubscribe.next(),this.ngUnsubscribe.complete())})}createOrUpdateRessource(e=null,t){return e?this.db.doc(`ressources/${e}`).update(t):(t.creator=this.auth.currentUser.value.id,t.created_at=i.a.firestore.FieldValue.serverTimestamp(),console.log("save :",t),this.db.collection("ressources").add(t))}getRessourceByUser(){let e=this.auth.currentUser.value.id;return this.db.collection("ressources",t=>t.where("creator","==",e)).snapshotChanges().pipe(Object(s.a)(e=>e.map(e=>{const t=e.payload.doc.data();return Object.assign({id:e.payload.doc.id},t)})),o(this.ngUnsubscribe))}getAdminRessources(){return this.db.collection("ressources").snapshotChanges().pipe(Object(s.a)(e=>e.map(e=>{const t=e.payload.doc.data();return Object.assign({id:e.payload.doc.id},t)})),o(this.ngUnsubscribe))}getRessource(e){return this.db.doc(`ressources/${e}`).valueChanges().pipe(Object(u.a)(1))}getUser(e){return this.db.doc(`users/${e}`).valueChanges().pipe(Object(u.a)(1))}deleteRessource(e){return this.db.doc(`ressources/${e}`).delete()}}return e.\u0275fac=function(t){return new(t||e)(d.Sb(b.a),d.Sb(h.a),d.Sb(f.a))},e.\u0275prov=d.Hb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},ZaV5:function(e,t,n){"use strict";n.d(t,"a",function(){return i}),n.d(t,"b",function(){return s});const i=async(e,t,n,i,s)=>{if(e)return e.attachViewToDom(t,n,s,i);if("string"!=typeof n&&!(n instanceof HTMLElement))throw new Error("framework delegate is missing");const r="string"==typeof n?t.ownerDocument&&t.ownerDocument.createElement(n):n;return i&&i.forEach(e=>r.classList.add(e)),s&&Object.assign(r,s),t.appendChild(r),r.componentOnReady&&await r.componentOnReady(),r},s=(e,t)=>{if(t){if(e)return e.removeViewFromDom(t.parentElement,t);t.remove()}return Promise.resolve()}},h3R7:function(e,t,n){"use strict";n.d(t,"a",function(){return i});const i={bubbles:{dur:1e3,circles:9,fn:(e,t,n)=>{const i=e*t/n-e+"ms",s=2*Math.PI*t/n;return{r:5,style:{top:9*Math.sin(s)+"px",left:9*Math.cos(s)+"px","animation-delay":i}}}},circles:{dur:1e3,circles:8,fn:(e,t,n)=>{const i=t/n,s=e*i-e+"ms",r=2*Math.PI*i;return{r:5,style:{top:9*Math.sin(r)+"px",left:9*Math.cos(r)+"px","animation-delay":s}}}},circular:{dur:1400,elmDuration:!0,circles:1,fn:()=>({r:20,cx:48,cy:48,fill:"none",viewBox:"24 24 48 48",transform:"translate(0,0)",style:{}})},crescent:{dur:750,circles:1,fn:()=>({r:26,style:{}})},dots:{dur:750,circles:3,fn:(e,t)=>({r:6,style:{left:9-9*t+"px","animation-delay":-110*t+"ms"}})},lines:{dur:1e3,lines:12,fn:(e,t,n)=>({y1:17,y2:29,style:{transform:`rotate(${30*t+(t<6?180:-180)}deg)`,"animation-delay":e*t/n-e+"ms"}})},"lines-small":{dur:1e3,lines:12,fn:(e,t,n)=>({y1:12,y2:20,style:{transform:`rotate(${30*t+(t<6?180:-180)}deg)`,"animation-delay":e*t/n-e+"ms"}})}}},mrSG:function(e,t,n){"use strict";function i(e,t,n,i){return new(n||(n=Promise))(function(s,r){function o(e){try{a(i.next(e))}catch(t){r(t)}}function c(e){try{a(i.throw(e))}catch(t){r(t)}}function a(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(o,c)}a((i=i.apply(e,t||[])).next())})}n.d(t,"a",function(){return i})},qULd:function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"b",function(){return o}),n.d(t,"c",function(){return s}),n.d(t,"d",function(){return a}),n.d(t,"e",function(){return c});const i={getEngine(){const e=window;return e.TapticEngine||e.Capacitor&&e.Capacitor.isPluginAvailable("Haptics")&&e.Capacitor.Plugins.Haptics},available(){return!!this.getEngine()},isCordova:()=>!!window.TapticEngine,isCapacitor:()=>!!window.Capacitor,impact(e){const t=this.getEngine();if(!t)return;const n=this.isCapacitor()?e.style.toUpperCase():e.style;t.impact({style:n})},notification(e){const t=this.getEngine();if(!t)return;const n=this.isCapacitor()?e.style.toUpperCase():e.style;t.notification({style:n})},selection(){this.impact({style:"light"})},selectionStart(){const e=this.getEngine();e&&(this.isCapacitor()?e.selectionStart():e.gestureSelectionStart())},selectionChanged(){const e=this.getEngine();e&&(this.isCapacitor()?e.selectionChanged():e.gestureSelectionChanged())},selectionEnd(){const e=this.getEngine();e&&(this.isCapacitor()?e.selectionEnd():e.gestureSelectionEnd())}},s=()=>{i.selection()},r=()=>{i.selectionStart()},o=()=>{i.selectionChanged()},c=()=>{i.selectionEnd()},a=e=>{i.impact(e)}},xWOS:function(e,t,n){"use strict";n.d(t,"a",function(){return C});var i=n("mrSG"),s=n("3Pt+"),r=n("fXoL"),o=n("TEn/"),c=n("XLi0"),a=n("ofXK"),u=n("lGQG");let l=(()=>{class e{constructor(e,t,n){this.authService=e,this.templateRef=t,this.viewContainer=n}ngOnInit(){this.authService.currentUser.subscribe(e=>{console.log("Droits de l'utilisateur : ",e.permissions),console.log("Permission requise : ",this.permissions),this.authService.hasPermissions(this.permissions)?this.viewContainer.createEmbeddedView(this.templateRef):this.viewContainer.clear()})}}return e.\u0275fac=function(t){return new(t||e)(r.Lb(u.a),r.Lb(r.M),r.Lb(r.R))},e.\u0275dir=r.Gb({type:e,selectors:[["","appHasPermission",""]],inputs:{permissions:["appHasPermission","permissions"]}}),e})();function d(e,t){1&e&&(r.Ob(0,"ion-card-title"),r.lc(1,"Cr\xe9ation de ressource"),r.Nb())}function b(e,t){if(1&e&&(r.Ob(0,"ion-card-title"),r.lc(1),r.Nb()),2&e){const e=r.Yb();r.Bb(1),r.nc("Ressource : #",e.id,"")}}const h=function(){return{standalone:!0}};function f(e,t){if(1&e){const e=r.Pb();r.Ob(0,"ion-item"),r.Ob(1,"ion-label"),r.lc(2,"Utilisateur"),r.Nb(),r.Ob(3,"ion-input",13),r.Wb("ngModelChange",function(t){return r.hc(e),r.Yb().user=t}),r.Nb(),r.Nb()}if(2&e){const e=r.Yb();r.Bb(3),r.ec("ngModel",e.user)("ngModelOptions",r.fc(2,h))}}function m(e,t){1&e&&(r.Ob(0,"ion-item"),r.Ob(1,"ion-label"),r.lc(2,"Status"),r.Nb(),r.Ob(3,"ion-segment",14),r.Ob(4,"ion-segment-button",15),r.Ob(5,"ion-label"),r.lc(6,"En attente"),r.Nb(),r.Mb(7,"ion-icon",16),r.Nb(),r.Ob(8,"ion-segment-button",17),r.Mb(9,"ion-icon",18),r.Ob(10,"ion-label"),r.lc(11,"Publi\xe9"),r.Nb(),r.Nb(),r.Nb(),r.Nb())}function p(e,t){1&e&&(r.Ob(0,"p"),r.lc(1,"Cr\xe9er"),r.Nb())}function g(e,t){1&e&&(r.Ob(0,"p"),r.lc(1,"Modifier"),r.Nb())}function y(e,t){if(1&e){const e=r.Pb();r.Ob(0,"ion-button",19),r.Wb("click",function(){return r.hc(e),r.Yb().deleteRessource()}),r.Mb(1,"ion-icon",20),r.Nb()}}const O=function(){return["change-ressource-status"]},v=function(){return["delete-ressource"]};let C=(()=>{class e{constructor(e,t,n,i,s){this.fb=e,this.modalCtrl=t,this.loadingCtrl=n,this.ressourceService=i,this.navParam=s,this.id=null,this.user=""}ngOnInit(){this.ressourceForm=this.fb.group({title:["",s.l.required],desc:["",s.l.required],status:0}),this.id=this.navParam.get("id"),this.id&&this.ressourceService.getRessource(this.id).subscribe(e=>{console.log(e),this.ressourceForm.patchValue({title:e.title,desc:e.desc,status:e.status}),this.ressourceForm.controls.title.disable(),this.ressourceForm.controls.desc.disable(),this.ressourceService.getUser(e.creator).subscribe(e=>{this.user=e.email})})}close(){this.modalCtrl.dismiss()}saveOrUpdate(){return Object(i.a)(this,void 0,void 0,function*(){let e=yield this.loadingCtrl.create({message:"Chargement..."});yield e.present(),this.ressourceService.createOrUpdateRessource(this.id,this.ressourceForm.value).then(()=>{e.dismiss(),this.close()},t=>{e.dismiss()})})}deleteRessource(){this.ressourceService.deleteRessource(this.id).then(()=>{this.modalCtrl.dismiss()})}}return e.\u0275fac=function(t){return new(t||e)(r.Lb(s.a),r.Lb(o.L),r.Lb(o.K),r.Lb(c.a),r.Lb(o.M))},e.\u0275cmp=r.Fb({type:e,selectors:[["app-ressource"]],decls:33,vars:11,consts:[["slot","start"],[3,"click"],["name","close"],[4,"ngIf"],[3,"formGroup","ngSubmit"],["position","floating"],["color","danger"],["required","","formControlName","title","type","text"],["required","","formControlName","desc","type","text"],[4,"appHasPermission"],["expand","block","color","primary","type","submit",1,"ion-margin-vertical","ion-margin-horizontal",3,"disabled"],["name","checkmark","slot","end"],["class","ion-margin-vertical ion-margin-horizontal","expand","block","color","danger",3,"click",4,"appHasPermission"],["type","text","disabled","true",3,"ngModel","ngModelOptions","ngModelChange"],["formControlName","status","mode","ios"],["value","0","layout","icon-start"],["name","radio-button-off"],["value","1","layout","icon-end"],["name","checkmark-circle"],["expand","block","color","danger",1,"ion-margin-vertical","ion-margin-horizontal",3,"click"],["name","trash","slot","end"]],template:function(e,t){1&e&&(r.Ob(0,"ion-header"),r.Ob(1,"ion-toolbar"),r.Ob(2,"ion-buttons",0),r.Ob(3,"ion-button",1),r.Wb("click",function(){return t.close()}),r.Mb(4,"ion-icon",2),r.Nb(),r.Nb(),r.Ob(5,"ion-title"),r.lc(6,"ressource"),r.Nb(),r.Nb(),r.Nb(),r.Ob(7,"ion-content"),r.Ob(8,"ion-card"),r.Ob(9,"ion-card-header"),r.kc(10,d,2,0,"ion-card-title",3),r.kc(11,b,2,1,"ion-card-title",3),r.Nb(),r.Ob(12,"ion-card-content"),r.Ob(13,"form",4),r.Wb("ngSubmit",function(){return t.saveOrUpdate()}),r.kc(14,f,4,3,"ion-item",3),r.Ob(15,"ion-item"),r.Ob(16,"ion-label",5),r.lc(17,"Titre "),r.Ob(18,"ion-text",6),r.lc(19,"*"),r.Nb(),r.Nb(),r.Mb(20,"ion-input",7),r.Nb(),r.Ob(21,"ion-item"),r.Ob(22,"ion-label",5),r.lc(23,"Contenu "),r.Ob(24,"ion-text",6),r.lc(25,"*"),r.Nb(),r.Nb(),r.Mb(26,"ion-textarea",8),r.Nb(),r.kc(27,m,12,0,"ion-item",9),r.Ob(28,"ion-button",10),r.Mb(29,"ion-icon",11),r.kc(30,p,2,0,"p",3),r.kc(31,g,2,0,"p",3),r.Nb(),r.kc(32,y,2,0,"ion-button",12),r.Nb(),r.Nb(),r.Nb(),r.Nb()),2&e&&(r.Bb(10),r.ec("ngIf",!t.id),r.Bb(1),r.ec("ngIf",t.id),r.Bb(2),r.ec("formGroup",t.ressourceForm),r.Bb(1),r.ec("ngIf",t.id),r.Bb(13),r.ec("appHasPermission",r.fc(9,O)),r.Bb(1),r.ec("disabled",!t.ressourceForm.valid),r.Bb(2),r.ec("ngIf",!t.id),r.Bb(1),r.ec("ngIf",t.id),r.Bb(1),r.ec("appHasPermission",r.fc(10,v)))},directives:[o.n,o.H,o.f,o.e,o.o,o.G,o.k,o.g,o.i,a.k,o.h,s.m,s.h,s.c,o.r,o.t,o.E,o.q,o.P,s.k,s.g,s.b,o.F,l,o.j,s.i,o.A,o.O,o.B],styles:[""]}),e})()}}]);